{
  "openapi": "3.1.0",
  "info": {
    "title": "Ambient AI Scribe API v2",
    "version": "2.0.0",
    "description": "Auth (password flow) for v2 API."
  },
  "servers": [{ "url": "https://api.staging.commure.com/ambient/scribe" }],
  "paths": {
    "/v1/auth/token": {
      "post": {
        "summary": "Obtain JWT (OAuth2 password flow)",
        "description": "Authenticate a user and receive a JWT. Send as application/x-www-form-urlencoded.",
        "tags": ["auth"],
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": { 
                    "type": "string", 
                    "description": "User email address" 
                  },
                  "password": { 
                    "type": "string", 
                    "format": "password",
                    "description": "User password"
                  }
                },
                "required": ["username", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "token": { 
                      "type": "string", 
                      "description": "JWT token" 
                    },
                    "token_type": { 
                      "type": "string", 
                      "enum": ["bearer"],
                      "description": "Token type"
                    },
                    "expires_in": {
                      "type": "integer",
                      "description": "Token expiration time in seconds"
                    }
                  },
                  "required": ["token", "token_type", "expires_in"]
                },
                "examples": {
                  "default": {
                    "value": {
                      "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
                      "token_type": "bearer",
                      "expires_in": 172800
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": { "type": "string" }
                  }
                },
                "examples": {
                  "invalid_credentials": {
                    "value": {
                      "detail": "Incorrect username or password"
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": { 
                      "type": "array",
                      "items": { "type": "object" }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": { "type": "string" }
                  }
                }
              }
            }
          }
        },
        "x-codeSamples": [
          {
            "lang": "cURL",
            "label": "Password flow",
            "source": "curl -X POST https://api.staging.commure.com/ambient/scribe/v1/auth/token \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  --data-urlencode 'username={email}' \\\n  --data-urlencode 'password={password}'"
          },
          {
            "lang": "JavaScript",
            "label": "Fetch JWT",
            "source": "const form = new URLSearchParams({username: process.env.AMBIENT_USER, password: process.env.AMBIENT_PASS});\nconst res = await fetch('https://api.staging.commure.com/ambient/scribe/v1/auth/token', { \n  method:'POST', \n  headers:{'Content-Type':'application/x-www-form-urlencoded'}, \n  body: form \n});\nconst {token, token_type, expires_in} = await res.json();"
          },
          {
            "lang": "Python",
            "label": "Requests JWT",
            "source": "import os, requests\nres = requests.post('https://api.staging.commure.com/ambient/scribe/v1/auth/token', data={\n  'username': os.environ['AMBIENT_USER'],\n  'password': os.environ['AMBIENT_PASS']\n})\ndata = res.json()\ntoken = data['token']"
          }
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": { "type": "http", "scheme": "bearer", "bearerFormat": "JWT" }
    }
  },
  "security": [{ "bearerAuth": [] }]
}

